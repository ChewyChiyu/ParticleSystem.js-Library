function ParticleEmitter(t,e){this.position={x:t,y:e},this.spawnRange={x:5,y:5},this.maxParticleCount=-1,this.particlesSpawned=0,this.particleSize={w:12,h:7},this.particleColor={r:0,g:0,b:0,a:1},this.particleAlphaRate=.01,this.scatterImpulse={max_dx:1.1,max_dy:1.1},this.particleSpawnRate=15,this.lifeSpeed=6,this.particles=[],this.spawnClock=null,this.particleLifeClock=null,this.affectedByGravity={bool:!0,gravity:.01}}function particleLife(t){null==t.spawnClock&&0==t.particles.length&&clearInterval(t.particleLifeClock);for(var e=0;e<t.particles.length;e++){var i=t.particles[e];i.alpha<=0?t.particles.splice(e,1):(i.x+=i.dx,i.y+=t.affectedByGravity?i.dy+=t.affectedByGravity.gravity:i.dy,i.alpha-=Math.abs(t.particleAlphaRate))}}function spawn(t){t.particlesSpawned++<t.maxParticleCount||-1==t.maxParticleCount?t.particles.push({x:t.position.x+getRandomNum(t.spawnRange.x),y:t.position.y+getRandomNum(t.spawnRange.y),dx:getRandomNum(t.scatterImpulse.max_dx),dy:getRandomNum(t.scatterImpulse.max_dy),alpha:t.particleColor.a}):(clearInterval(t.spawnClock),t.spawnClock=null)}function getRandomNum(t){return Math.random()<.5?Math.random()*t:-(Math.random()*t)}ParticleEmitter.prototype={setMaxParticleCount:function(t){return Number.isInteger(t)&&(this.maxParticleCount=t),this},isAffectedByGravity:function(t,e){return t&&Number.isInteger(e)?this.affectedByGravity={bool:!0,gravity:e}:this.affectedByGravity.bool=!1,this},setSpawnRange:function(t,e){return Number.isInteger(t)&&Number.isInteger(e)&&(this.spawnRange={x:t,y:e}),this},setParticleSize:function(t,e){return Number.isInteger(t)&&Number.isInteger(e)&&(this.particleSize={w:t,h:e}),this},setParticleColor:function(t,e,i,a){return Number.isInteger(t)&&Number.isInteger(e)&&Number.isInteger(i)&&Number.isInteger(a)&&(this.particleColor={r:t,g:e,b:i,a:a}),this},setAlphaRate:function(t){return Number.isInteger(t)&&1>=t&&t>=0&&(this.particleAlphaRate=t),this},setScatterImpulse:function(t,e){return Number.isInteger(t)&&Number.isInteger(e)&&(this.scatterImpulse={max_dx:t,max_dy:e}),this},setParticleSpawnRate:function(t){return Number.isInteger(t)&&(this.particleSpawnRate=t),this},setLifeTime:function(t){return Number.isInteger(t)&&(this.lifeSpeed=t),this},startSpawn:function(){return null==this.spawnClock&&null==this.particleLifeClock&&(this.spawnClock=setInterval(spawn,this.particleSpawnRate,this),this.particleLifeClock=setInterval(particleLife,this.lifeSpeed,this)),this},drawEmitter:function(t){if(null!=t){for(var e=t.getContext("2d"),i=0;i<this.particles.length;i++){var a=this.particles[i];e.fillStyle="rgba("+this.particleColor.r+","+this.particleColor.g+","+this.particleColor.b+","+a.alpha+")",e.fillRect(a.x,a.y,this.particleSize.w,this.particleSize.h)}return this}}};